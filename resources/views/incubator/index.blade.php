<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>Inkubator Tanaman - Smart Buncop</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ asset('css/incubator.css') }}">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo-container">
                    <i class="fas fa-egg logo-icon"></i>
                    <h1 class="site-title">Inkubator Tanaman</h1>
                </div>
                <p class="tagline">Sistem kontrol suhu, kelembaban, dan pencahayaan untuk pertumbuhan optimal</p>
            </div>
            <div class="leaf-decoration">
                <i class="fas fa-leaf"></i>
                <i class="fas fa-leaf"></i>
                <i class="fas fa-leaf"></i>
            </div>
        </header>

        <!-- Notification Banner -->
        <div id="notificationBanner" class="notification-banner" style="display: none;">
            <div class="notification-content">
                <i class="fas fa-exclamation-triangle"></i>
                <span id="bannerMessage"></span>
                <button id="closeBanner" class="close-banner"><i class="fas fa-times"></i></button>
            </div>
        </div>

        <!-- Dashboard -->
        <main class="dashboard">
            <!-- Panel Status Sensor -->
            <section class="panel sensor-panel">
                <div class="panel-header">
                    <i class="fas fa-thermometer-half panel-icon"></i>
                    <h2>Status Lingkungan</h2>
                    <span class="update-time" id="sensorUpdateTime">--:--</span>
                    <span class="current-mode" id="currentModeBadge">MANUAL</span>
                </div>

                <div class="sensor-grid">
                    <!-- Sensor Suhu -->
                    <div class="sensor-card temperature-card">
                        <div class="sensor-icon">
                            <i class="fas fa-temperature-high"></i>
                        </div>
                        <div class="sensor-info">
                            <h3 class="sensor-title">Suhu</h3>
                            <div class="sensor-value" id="temperatureValue">--.-</div>
                            <div class="sensor-unit">°C</div>
                            <div class="sensor-status" id="temperatureStatus">Membaca...</div>
                        </div>
                        <div class="sensor-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="tempProgress"></div>
                            </div>
                            <div class="progress-labels">
                                <span>0°C</span>
                                <span id="tempRange">26-33°C</span>
                                <span>50°C</span>
                            </div>
                        </div>
                    </div>

                    <!-- Sensor Kelembaban -->
                    <div class="sensor-card humidity-card">
                        <div class="sensor-icon">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="sensor-info">
                            <h3 class="sensor-title">Kelembaban</h3>
                            <div class="sensor-value" id="humidityValue">--.-</div>
                            <div class="sensor-unit">%</div>
                            <div class="sensor-status" id="humidityStatus">Membaca...</div>
                        </div>
                        <div class="sensor-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="humProgress"></div>
                            </div>
                            <div class="progress-labels">
                                <span>0%</span>
                                <span>Optimal</span>
                                <span>100%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Panel Mode Kontrol -->
            <section class="panel mode-panel">
                <div class="panel-header">
                    <i class="fas fa-cogs panel-icon"></i>
                    <h2>Mode Kontrol</h2>
                </div>

                <div class="mode-selector">
                    <button class="mode-btn auto-mode" id="autoModeBtn">
                        <i class="fas fa-robot"></i>
                        <span>AUTO</span>
                        <div class="mode-description">Kontrol otomatis berdasarkan suhu</div>
                    </button>
                    <button class="mode-btn manual-mode active" id="manualModeBtn">
                        <i class="fas fa-hand-paper"></i>
                        <span>MANUAL</span>
                        <div class="mode-description">Kontrol manual dari website</div>
                    </button>
                </div>
            </section>

            <!-- Panel Informasi Tanaman -->
            <section class="panel plant-panel">
                <div class="panel-header">
                    <i class="fas fa-leaf panel-icon"></i>
                    <h2>Informasi Tanaman</h2>
                </div>

                <div class="plant-control">
                    <div class="plant-selector">
                        <h3 class="section-title">Pilih Tanaman</h3>
                        <div class="plant-options">
                            <!-- Akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <div class="plant-info" id="plantInfo">
                        <div class="info-header">
                            <div class="plant-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="plant-details">
                                <h4 class="plant-name">Belum ada tanaman</h4>
                                <div class="plant-status">Pilih tanaman untuk melihat kebutuhan</div>
                            </div>
                        </div>

                        <div class="requirements">
                            <div class="requirement-item">
                                <div class="req-icon">
                                    <i class="fas fa-thermometer-half"></i>
                                </div>
                                <div class="req-details">
                                    <div class="req-label">Suhu Optimal</div>
                                    <div class="req-value" id="tempRequirement">--°C</div>
                                    <div class="req-progress">
                                        <div class="req-bar">
                                            <div class="req-fill" id="tempReqFill"></div>
                                        </div>
                                        <div class="req-range" id="tempReqRange">Min: --°C, Max: --°C</div>
                                    </div>
                                </div>
                            </div>

                            <div class="requirement-item">
                                <div class="req-icon">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="req-details">
                                    <div class="req-label">Kelembaban</div>
                                    <div class="req-value" id="humidityRequirement">--%</div>
                                    <div class="req-progress">
                                        <div class="req-bar">
                                            <div class="req-fill" id="humidityReqFill"></div>
                                        </div>
                                        <div class="req-range" id="humidityReqRange">Optimal: --%</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Custom Tanaman (lengkap) -->
                        <div class="plant-custom" id="plantCustomForm" style="display: none;">
                            <h4 class="custom-title">Tanaman Custom</h4>
                            <div class="custom-form">
                                <div class="form-group">
                                    <label for="customName">Nama Tanaman</label>
                                    <input type="text" id="customName" placeholder="Masukkan nama tanaman">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="customMinTemp">Suhu Min (°C)</label>
                                        <input type="number" id="customMinTemp" min="0" max="40" value="20">
                                    </div>
                                    <div class="form-group">
                                        <label for="customMaxTemp">Suhu Max (°C)</label>
                                        <input type="number" id="customMaxTemp" min="10" max="50" value="30">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="customLightPWM">Kecerahan Lampu (0-100%)</label>
                                        <input type="range" id="customLightPWM" min="0" max="100" value="60">
                                        <span id="customLightValue">60%</span>
                                    </div>
                                    <div class="form-group">
                                        <label for="customDuration">Durasi Penyiraman (detik)</label>
                                        <input type="number" id="customDuration" min="1" max="60" value="10">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="customLightStartDate">Mulai Penyinaran (Tanggal)</label>
                                    <input type="date" id="customLightStartDate">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="customLightStartTime">Jam Mulai Lampu</label>
                                        <input type="time" id="customLightStartTime" value="06:00">
                                    </div>
                                    <div class="form-group">
                                        <label for="customLightEndTime">Jam Selesai Lampu</label>
                                        <input type="time" id="customLightEndTime" value="17:00">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Hari Penyinaran Aktif</label>
                                    <div class="day-checkboxes" id="customLightDays">
                                        <label><input type="checkbox" value="1" checked> Sen</label>
                                        <label><input type="checkbox" value="2" checked> Sel</label>
                                        <label><input type="checkbox" value="3" checked> Rab</label>
                                        <label><input type="checkbox" value="4" checked> Kam</label>
                                        <label><input type="checkbox" value="5" checked> Jum</label>
                                        <label><input type="checkbox" value="6" checked> Sab</label>
                                        <label><input type="checkbox" value="0" checked> Min</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Jam Penyiraman</label>
                                    <div id="customScheduleList" class="schedule-list"></div>
                                    <button type="button" class="btn-secondary" id="customAddScheduleBtn">
                                        <i class="fas fa-plus"></i> Tambah Jam
                                    </button>
                                </div>

                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="customAuto" checked> Mode Otomatis
                                    </label>
                                </div>

                                <div class="form-actions">
                                    <button class="btn-secondary" id="cancelCustomBtn">
                                        <i class="fas fa-times"></i> Batal
                                    </button>
                                    <button class="btn-primary" id="saveCustomBtn">
                                        <i class="fas fa-save"></i> Simpan Tanaman
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Aksi Tanaman -->
                        <div class="plant-actions" id="plantActions" style="display: none;">
                            <button class="btn-secondary" id="editPlantBtn">
                                <i class="fas fa-edit"></i> Edit Tanaman
                            </button>
                            <button class="btn-primary" id="applySettingsBtn">
                                <i class="fas fa-check-circle"></i> Terapkan Pengaturan
                            </button>
                            <button class="btn-secondary" id="removePlantBtn">
                                <i class="fas fa-trash"></i> Hapus Tanaman
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Panel Tumbuhan Aktif -->
            <section class="panel activity-panel">
                <div class="panel-header">
                    <i class="fas fa-seedling panel-icon"></i>
                    <h2>Tumbuhan yang Aktif</h2>
                </div>
                <div class="active-plant-card" id="activePlantCard">
                    <div class="active-plant-empty" id="activePlantEmpty">
                        Belum ada tumbuhan aktif.
                    </div>
                    <div class="active-plant-content" id="activePlantContent" style="display: none;">
                        <div class="active-plant-title" id="activePlantTitle">-</div>
                        <div class="active-plant-meta" id="activePlantMeta">-</div>
                        <div class="active-plant-group-title">
                            <i class="fas fa-sliders-h"></i> Pengaturan Aktif
                        </div>
                        <div class="active-plant-settings" id="activePlantSettings"></div>
                        <div class="active-plant-group-title">
                            <i class="fas fa-microchip"></i> Status Perangkat
                        </div>
                        <div class="active-plant-systems" id="activePlantSystems"></div>
                        <div class="active-plant-actions">
                            <button class="btn-secondary" id="finishActivePlantBtn">
                                <i class="fas fa-check"></i> Selesai
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Panel Kontrol Perangkat -->
            <section class="panel device-panel">
                <div class="panel-header">
                    <i class="fas fa-sliders-h panel-icon"></i>
                    <h2>Kontrol Perangkat</h2>
                </div>

                <div class="device-controls">
                    <!-- Kontrol Relay -->
                    <div class="device-section">
                        <h3 class="section-title">Kontrol Relay</h3>
                        <div class="relay-grid">
                            <!-- Kipas -->
                            <div class="relay-card" id="kipasCard">
                                <div class="relay-header">
                                    <div class="relay-icon">
                                        <i class="fas fa-wind"></i>
                                    </div>
                                    <h4 class="relay-name">Kipas</h4>
                                </div>
                                <div class="relay-status">
                                    <span class="status-label">Status:</span>
                                    <span class="status-value" id="kipasStatus">OFF</span>
                                </div>
                                <div class="relay-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="kipasToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>

                            <!-- Sprayer -->
                            <div class="relay-card" id="sprayerCard">
                                <div class="relay-header">
                                    <div class="relay-icon">
                                        <i class="fas fa-spray-can"></i>
                                    </div>
                                    <h4 class="relay-name">Sprayer</h4>
                                </div>
                                <div class="relay-status">
                                    <span class="status-label">Status:</span>
                                    <span class="status-value" id="sprayerStatus">OFF</span>
                                </div>
                                <div class="relay-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="sprayerToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <!-- Countdown Sprayer -->
                                <div class="sprayer-countdown" id="sprayerCountdown" style="display: none; margin-top: 10px;">
                                    <i class="fas fa-hourglass-half"></i>
                                    <span id="countdownTime">0s</span>
                                </div>
                            </div>

                            <!-- Lampu Relay (Pemanas) -->
                            <div class="relay-card" id="lampuRelayCard">
                                <div class="relay-header">
                                    <div class="relay-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <h4 class="relay-name">Lampu Pemanas</h4>
                                </div>
                                <div class="relay-status">
                                    <span class="status-label">Status:</span>
                                    <span class="status-value" id="lampuRelayStatus">OFF</span>
                                </div>
                                <div class="relay-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="lampuRelayToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Kontrol PWM Lampu -->
                    <div class="device-section">
                        <h3 class="section-title">Kontrol Lampu LED</h3>
                        <div class="lamp-control">
                            <div class="lamp-info">
                                <div class="lamp-icon">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <div class="lamp-details">
                                    <h4 class="lamp-name">Lampu Grow LED</h4>
                                    <div class="lamp-status" id="lampPWMStatus">OFF</div>
                                </div>
                            </div>
                            <div class="lamp-power">
                                <label class="power-toggle">
                                    <input type="checkbox" id="lampPWMToggle">
                                    <span class="power-slider">
                                        <span class="power-on">ON</span>
                                        <span class="power-off">OFF</span>
                                    </span>
                                </label>
                            </div>
                            <div class="lamp-brightness">
                                <div class="brightness-header">
                                    <span>Kecerahan</span>
                                    <span id="brightnessValue">60%</span>
                                </div>
                                <input type="range" id="brightnessSlider" min="0" max="100" value="60" class="brightness-slider">
                                <div class="brightness-labels">
                                    <span>0%</span>
                                    <span>50%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Panel Setpoint Suhu -->
            <section class="panel setpoint-panel">
                <div class="panel-header">
                    <i class="fas fa-thermometer-half panel-icon"></i>
                    <h2>Pengaturan Suhu</h2>
                </div>

                <div class="setpoint-control">
                    <div class="setpoint-item">
                        <div class="setpoint-label">
                            <i class="fas fa-thermometer-empty"></i>
                            <span>Suhu Minimum</span>
                        </div>
                        <div class="setpoint-input">
                            <input type="number" id="minTemp" min="0" max="50" value="26">
                            <span class="unit">°C</span>
                        </div>
                        <div class="setpoint-description">
                            Lampu pemanas ON jika suhu &lt; minimum
                        </div>
                    </div>

                    <div class="setpoint-item">
                        <div class="setpoint-label">
                            <i class="fas fa-thermometer-full"></i>
                            <span>Suhu Maksimum</span>
                        </div>
                        <div class="setpoint-input">
                            <input type="number" id="maxTemp" min="0" max="50" value="33">
                            <span class="unit">°C</span>
                        </div>
                        <div class="setpoint-description">
                            Kipas ON jika suhu &gt; maksimum
                        </div>
                    </div>

                    <div class="setpoint-action">
                        <button class="btn-primary" id="saveSetpointBtn">
                            <i class="fas fa-save"></i> Simpan Setpoint
                        </button>
                    </div>
                </div>
            </section>

            <!-- Panel Jadwal Sprayer (Dinamis) -->
            <section class="panel schedule-panel">
                <div class="panel-header">
                    <i class="fas fa-clock panel-icon"></i>
                    <h2>Jadwal Sprayer</h2>
                </div>

                <div class="schedule-control">
                    <div class="schedule-list" id="scheduleList">
                        <!-- Daftar waktu akan diisi JavaScript -->
                    </div>

                    <div class="schedule-add">
                        <button class="btn-secondary" id="addScheduleBtn">
                            <i class="fas fa-plus"></i> Tambah Waktu
                        </button>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-label">
                            <i class="fas fa-sun"></i>
                            <span>Jadwal Penyinaran Lampu</span>
                        </div>
                        <div class="schedule-input">
                            <input type="date" id="lampStartDate">
                            <input type="time" id="lampStartTime" value="06:00">
                            <input type="time" id="lampEndTime" value="17:00">
                        </div>
                        <div class="day-checkboxes" id="lampActiveDays" style="margin-top:12px;">
                            <label><input type="checkbox" value="1" checked> Sen</label>
                            <label><input type="checkbox" value="2" checked> Sel</label>
                            <label><input type="checkbox" value="3" checked> Rab</label>
                            <label><input type="checkbox" value="4" checked> Kam</label>
                            <label><input type="checkbox" value="5" checked> Jum</label>
                            <label><input type="checkbox" value="6" checked> Sab</label>
                            <label><input type="checkbox" value="0" checked> Min</label>
                        </div>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-label">
                            <i class="fas fa-hourglass-half"></i>
                            <span>Durasi Sprayer</span>
                        </div>
                        <div class="schedule-input">
                            <input type="number" id="sprayerDurasi" min="1" max="60" value="5">
                            <span class="unit">detik</span>
                        </div>
                    </div>

                    <div class="schedule-status">
                        <div class="status-item">
                            <i class="fas fa-info-circle"></i>
                            <span>Mode AUTO: Jadwal mengikuti tanaman yang dipilih</span>
                        </div>
                        <div class="status-item">
                            <i class="fas fa-hand-paper"></i>
                            <span>Mode MANUAL: Jadwal dapat diatur bebas</span>
                        </div>
                    </div>

                    <div class="schedule-action">
                        <button class="btn-primary" id="saveSprayerBtn">
                            <i class="fas fa-calendar-check"></i> Simpan Jadwal
                        </button>
                    </div>
                </div>
            </section>

            <!-- Panel Status Sistem -->
            <section class="panel status-panel">
                <div class="panel-header">
                    <i class="fas fa-info-circle panel-icon"></i>
                    <h2>Status Sistem</h2>
                </div>

                <div class="system-status">
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="status-icon">
                                <i class="fas fa-wifi"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">WiFi</div>
                                <div class="status-value online" id="wifiStatus">Terhubung</div>
                            </div>
                        </div>

                        <div class="status-item">
                            <div class="status-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">Firebase</div>
                                <div class="status-value online" id="firebaseStatus">Aktif</div>
                            </div>
                        </div>

                        <div class="status-item">
                            <div class="status-icon">
                                <i class="fas fa-microchip"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">ESP32</div>
                                <div class="status-value online" id="esp32Status">Online</div>
                            </div>
                        </div>

                        <div class="status-item">
                            <div class="status-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div class="status-info">
                                <div class="status-label">Stream</div>
                                <div class="status-value online" id="streamStatus">Aktif</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="connection-info">
                    <div class="connection-status">
                        <div class="status-dot connected" id="connectionDot"></div>
                        <span class="status-text" id="connectionText">Terhubung ke Firebase</span>
                    </div>
                    <div class="last-update" id="lastUpdate">
                        <i class="fas fa-clock"></i>
                        <span>Terakhir update: --:--:--</span>
                    </div>
                </div>
                <div class="system-info">
                    <p>Inkubator Tanaman • Sistem IoT untuk Pertumbuhan Optimal</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

    <!-- Custom JS -->
    <script src="{{ asset('js/incubator.js') }}"></script>
</body>

</html>
